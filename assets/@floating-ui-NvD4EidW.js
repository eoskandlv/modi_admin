const I=Math.min,$=Math.max,R=Math.round,E=Math.floor,O=t=>({x:t,y:t});function q(t){const{x:e,y:n,width:i,height:o}=t;return{width:i,height:o,top:n,left:e,right:e+i,bottom:n+o,x:e,y:n}}function B(t){return W(t)?(t.nodeName||"").toLowerCase():"#document"}function g(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function V(t){var e;return(e=(W(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function W(t){return t instanceof Node||t instanceof g(t).Node}function P(t){return t instanceof Element||t instanceof g(t).Element}function L(t){return t instanceof HTMLElement||t instanceof g(t).HTMLElement}function M(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof g(t).ShadowRoot}function H(t){const{overflow:e,overflowX:n,overflowY:i,display:o}=N(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(o)}function U(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function j(t){return["html","body","#document"].includes(B(t))}function N(t){return g(t).getComputedStyle(t)}function k(t){if(B(t)==="html")return t;const e=t.assignedSlot||t.parentNode||M(t)&&t.host||V(t);return M(e)?e.host:e}function _(t){const e=k(t);return j(e)?t.ownerDocument?t.ownerDocument.body:t.body:L(e)&&H(e)?e:_(e)}function F(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const o=_(t),c=o===((i=t.ownerDocument)==null?void 0:i.body),r=g(o);if(c){const s=C(r);return e.concat(r,r.visualViewport||[],H(o)?o:[],s&&n?F(s):[])}return e.concat(o,F(o,[],n))}function C(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function K(t){const e=N(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const o=L(t),c=o?t.offsetWidth:n,r=o?t.offsetHeight:i,s=R(n)!==c||R(i)!==r;return s&&(n=c,i=r),{width:n,height:i,$:s}}function T(t){return P(t)?t:t.contextElement}function z(t){const e=T(t);if(!L(e))return O(1);const n=e.getBoundingClientRect(),{width:i,height:o,$:c}=K(e);let r=(c?R(n.width):n.width)/i,s=(c?R(n.height):n.height)/o;return(!r||!Number.isFinite(r))&&(r=1),(!s||!Number.isFinite(s))&&(s=1),{x:r,y:s}}const X=O(0);function Y(t){const e=g(t);return!U()||!e.visualViewport?X:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function G(t,e,n){return!1}function A(t,e,n,i){e===void 0&&(e=!1);const o=t.getBoundingClientRect(),c=T(t);let r=O(1);e&&(r=z(t));const s=G()?Y(c):O(0);let a=(o.left+s.x)/r.x,u=(o.top+s.y)/r.y,v=o.width/r.x,p=o.height/r.y;if(c){const y=g(c),d=i;let w=y,f=C(w);for(;f&&i&&d!==w;){const h=z(f),l=f.getBoundingClientRect(),m=N(f),b=l.left+(f.clientLeft+parseFloat(m.paddingLeft))*h.x,x=l.top+(f.clientTop+parseFloat(m.paddingTop))*h.y;a*=h.x,u*=h.y,v*=h.x,p*=h.y,a+=b,u+=x,w=g(f),f=C(w)}}return q({width:v,height:p,x:a,y:u})}function J(t,e){let n=null,i;const o=V(t);function c(){var s;clearTimeout(i),(s=n)==null||s.disconnect(),n=null}function r(s,a){s===void 0&&(s=!1),a===void 0&&(a=1),c();const{left:u,top:v,width:p,height:y}=t.getBoundingClientRect();if(s||e(),!p||!y)return;const d=E(v),w=E(o.clientWidth-(u+p)),f=E(o.clientHeight-(v+y)),h=E(u),m={rootMargin:-d+"px "+-w+"px "+-f+"px "+-h+"px",threshold:$(0,I(1,a))||1};let b=!0;function x(D){const S=D[0].intersectionRatio;if(S!==a){if(!b)return r();S?r(!1,S):i=setTimeout(()=>{r(!1,1e-7)},1e3)}b=!1}try{n=new IntersectionObserver(x,{...m,root:o.ownerDocument})}catch{n=new IntersectionObserver(x,m)}n.observe(t)}return r(!0),c}function Q(t,e,n,i){i===void 0&&(i={});const{ancestorScroll:o=!0,ancestorResize:c=!0,elementResize:r=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:a=!1}=i,u=T(t),v=o||c?[...u?F(u):[],...F(e)]:[];v.forEach(l=>{o&&l.addEventListener("scroll",n,{passive:!0}),c&&l.addEventListener("resize",n)});const p=u&&s?J(u,n):null;let y=-1,d=null;r&&(d=new ResizeObserver(l=>{let[m]=l;m&&m.target===u&&d&&(d.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame(()=>{var b;(b=d)==null||b.observe(e)})),n()}),u&&!a&&d.observe(u),d.observe(e));let w,f=a?A(t):null;a&&h();function h(){const l=A(t);f&&(l.x!==f.x||l.y!==f.y||l.width!==f.width||l.height!==f.height)&&n(),f=l,w=requestAnimationFrame(h)}return n(),()=>{var l;v.forEach(m=>{o&&m.removeEventListener("scroll",n),c&&m.removeEventListener("resize",n)}),p==null||p(),(l=d)==null||l.disconnect(),d=null,a&&cancelAnimationFrame(w)}}export{Q as a};
